<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <title>GodDodge</title>
    <meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="full-screen" content="true" />
    <meta name="screen-orientation" content="portrait" />
    <meta name="x5-fullscreen" content="true" />
    <meta name="360-fullscreen" content="true" />
    <link rel="icon" type="image/png" href="resource/assets/player.png" /> 
    <style> html, body { -ms-touch-action: none; background: #000000; padding: 0; border: 0; margin: 0; height: 100%; } </style>
</head>

<body>
    <div style="color: white; position: absolute; left:30px;">
        <p>edwin.channel.tw@gmail.com</p>
        <p>Please wait for download!</p>
        <p>pc : control <-left  ->right</p>
        <p>mobile : tap screen</p>
        <p>powered by egret engine</p>
        <p><a href="https://www.cutercounter.com/traditional-chinese-n/" target="_blank"><img src="https://www.cutercounter.com/hits.php?id=hexdacoa&nd=6&style=2" border="0" alt="免費網站計數器"></a></p>
    </div>
    <div style="margin: auto;width: 100%;height: 100%;" class="egret-player"
         data-entry-class="Main"
         data-orientation="auto"
         data-scale-mode="showAll"
         data-frame-rate="30"
         data-content-width="640"
         data-content-height="1136"
         data-multi-fingered="2"
         data-show-fps="false" data-show-log="false"
         data-show-fps-style="x:0,y:0,size:12,textColor:0xffffff,bgAlpha:0.9">
    </div>
<script>
    /** 
     * 由 Edwin Channel 製作
     *
     * 歡迎來到 EDWIN CHANNEL
     * [github] https://github.com/edwin-channel/egret
     * [youtube] https://www.youtube.com/channel/UC22aGo0GmUgt2_WeDwZpahQ
     * [gmail] edwin.channel.tw@gmail.com
     */

    fetch('./manifest.json?v=' + Math.random()).then(response => response.json()).then(async manifest => {
        var list = manifest.initial.concat(manifest.game);
        
        function loadScript(src) {
            return new Promise(resolve => {
                var s = document.createElement('script');
                s.async = false;
                s.src = src;
                s.addEventListener('load', function () {
                    s.parentNode.removeChild(s);
                    s.removeEventListener('load', arguments.callee, false);
                    resolve();
                }, false);
                document.body.appendChild(s);
            });
        }

        let pList = [];
        for(let i = 0; i < list.length; i++) 
            pList.push(loadScript(list[i]));
        await Promise.all(pList);
        RES.setMaxLoadingThread(16);

        egret.runEgret({ renderMode: "webgl", audioType: 0, calculateCanvasScaleFactor:function(context) {
            var backingStore = context.backingStorePixelRatio ||
                context.webkitBackingStorePixelRatio ||
                context.mozBackingStorePixelRatio ||
                context.msBackingStorePixelRatio ||
                context.oBackingStorePixelRatio ||
                context.backingStorePixelRatio || 1;
            return (window.devicePixelRatio || 1) / backingStore;
        }});
    })
</script>
</body>

</html>